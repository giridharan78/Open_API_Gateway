<Project><VisualAgenda><Agenda CallBack="Do_Agenda" ClonedXML="0" StartJSBlockLine="33" JSBlockLength="0"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0"/><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript></NodeScript><NodeID Visible="0">1</NodeID><InitAgenda Type="JavaScript" ReadOnly="0">
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This is the Reward Details and Reward Redemption directly to Db from JBOSS. Presently  being used by Pizza Express etc
Access token is not required for Get Reward Details. IF RIP values are greater than 1000 points it will be challaned every time.

UPDATE REWARD_ITEM_PRICE
set RIP_N_POINTS = 1
where RIP_V_REWARD_ITEM_ID IN
(select RIP.RIP_V_REWARD_ITEM_ID from REWARD_ITEM_PRICE RIP, REWARD_ITEM RI
where RIP.RIP_V_REWARD_ITEM_ID = RI.RIT_V_REWARD_ITEM_ID
AND  RI.RIT_V_REWARD_OFFER_ID IN ('ROM0009492','ROM0009351','ROM0009352','ROM0009355','ROM0009356','ROM0009358','ROM0009507',
'ROM0013409','ROM0009364','ROM0009353','ROM0009545','ROM0009538','ROM0009542','ROM0009373','ROM0009376','ROM0009376',
'ROM0009377','ROM0013172','ROM0009430','ROM0013368','ROM0013868','ROM0013928'))
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/

IncludeFile("C:\\PerformanceTesting\\Projects\\ACTIVE_Environment.js")
 IncludeFile("C:\\PerformanceTesting\\Projects\\STD_INCLUDES\\RandomString.js")
env_details()
Reward_File = CopyFile(Get_OAuth_RewardDetails_File)
   
Col_CardNo_File= CopyFile(Get_OAuth_mtoken_File)
</InitAgenda><InitClient Type="JavaScript" ReadOnly="0">Col_CardNo_DataFileParam = WLDataFileParam ( "Col_CardNo",Col_CardNo_File, 0,",",WLParamRandom,WLParamLocal,WLParamUpdateRound,WLParamCycle);
Col_CardNo_Col1 = WLDataFileField( Col_CardNo_DataFileParam, 1);
Col_CardNo_Col2 = WLDataFileField( Col_CardNo_DataFileParam, 2);

Reward_DataFileParam = WLDataFileParam ( "Reward",Reward_File, 0,",",WLParamRandom,WLParamLocal,WLParamUpdateRound,WLParamCycle);
Reward_Col1 = WLDataFileField( Reward_DataFileParam, 1);
</InitClient><TerminateAgenda Type="JavaScript" ReadOnly="0"></TerminateAgenda><TerminateClient Type="JavaScript" ReadOnly="0"></TerminateClient><JSNodeCounter Visible="0">69</JSNodeCounter></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="GlobalVariables"><System Type="Array" ReadOnly="0"><Variable Name="ClientNum" Description="Returns the main thread number for each client"/><Variable Name="GeneratorName()" Description="Returns the name of this load generator as a string"/><Variable Name="GMTDate()" Description="Current date in GMT/UTC as a string"/><Variable Name="Hours()" Description="Current Hour (0-23)"/><Variable Name="LocalDate()" Description="Current date in local time as a string"/><Variable Name="Milliseconds()" Description="Current ms value"/><Variable Name="Minutes()" Description="Current minutes (0-59)"/><Variable Name="RandomNumber()" Description="Generate a random number"/><Variable Name="RoundNum" Description="Returns the number of rounds for the specific client"/><Variable Name="Seconds()" Description="Current seconds (0-59)"/><Variable Name="ThisYear()" Description="Current Year (4-digit, e.g. 2001)"/><Variable Name="Time()" Description="Time in ms since 1/1/1970"/><Variable Name="TodaysDate()" Description="Current date (1-31)"/><Variable Name="TodaysDay()" Description="Current Day (0-6, 0==Sunday)"/><Variable Name="TodaysMonth()" Description="Current Month (0-11)"/><Variable Name="VCUniqueID()" Description="Returns a string unique to this VC"/></System><ParameterManagerData CallBack="Do_ParameterManagerData"><Array ArrayName="Parameters" ArrayLen="0" NewParamIndex="2"/></ParameterManagerData><UserDefined Type="Array" ReadOnly="0"/><InputParameters Type="Array" ReadOnly="0"/><OutputParameters Type="Array" ReadOnly="0"/><GlobalInputFilesParams Type="Array" ReadOnly="0"/><FileCounter>0</FileCounter></PropertyPage></Properties><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="279"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:29 *****/
/*This piece of code would generate the code for the OAuth . The Jar files should be placed in the extensions/java directory of the Parent Webload Directory. Jar files need to be placed in the LG's as well.
1. API.jar
2. nectar-openapi-transaction-services-3.3-SNAPSHOT.jar
3.  nectar-openapi-common-domain-1.5-SNAPSHOT.jar
4.  aerogear-otp-java-1.0.0.jar 
5.  domain-3.3.1.jar*/

code = new Packages.secureCode.CardCode();
a = code.extractCardNumberCode(Col_CardNo_Col2.getValue());
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


// This code is to generate a random number to pick Random RIP values


function trans() {
	                     var rnum = Math.floor(Math.random() * 5 + 1);
	         return rnum 
                   }	
// END WLIDE</NodeScript><NodeID Visible="0">29</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:29 *****/
function transID() {
	                     var rnum = Math.floor(Math.random() * 10 + 1);
	         return rnum 
                   }	
// END WLIDE
</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">33</StartJSBlockLine><JSBlockLength Visible="0">22</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="280"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:21 *****/
var reqID = requestID ()
 z = trans()

 // END WLIDE</NodeScript><NodeID Visible="0">21</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">55</StartJSBlockLine><JSBlockLength Visible="0">6</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="281"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:6 *****/
wlHttp.SSLClientCertificateFile = "C:\\PerformanceTesting\\Projects\\STD_DATA\\T0_DATA\\CERTIFICATES\\webload.pem"
wlHttp.SSLClientCertificatePassword = "webload"

 // END WLIDE</NodeScript><NodeID Visible="0">6</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">61</StartJSBlockLine><JSBlockLength Visible="0">6</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="282"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">BeginTransaction::01_Reward_Details</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - BeginTransaction::01_Reward_Details - ID:2 *****/
BeginTransaction("01_Reward_Details")

 // END WLIDE</NodeScript><NodeID Visible="0">2</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">67</StartJSBlockLine><JSBlockLength Visible="0">5</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="283"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:3 *****/
wlGlobals.SSLUseSNI = true;
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.Header["Content-Type"] ="application/x-www-form-urlencoded"
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Get("https://api.t0.nectar.com/rewards/"+Reward_Col1.getValue()+"")

var1 = extractValue( "&lt;redeemableId&gt;","&lt;/redeemableId&gt;", document.wlSource)
myData = extractValue("&lt;id&gt;","&lt;/id&gt;",document.wlSource,z)
//Example: Pizza Express Reward Offer Id is ROM0013368
//Example: Sainsbury internal evoucher Offer id is ROM0009529,ROM0009378
 // END WLIDE</NodeScript><NodeID Visible="0">3</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">72</StartJSBlockLine><JSBlockLength Visible="0">14</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="284"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">EndTransaction::01_Reward_Details</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - EndTransaction::01_Reward_Details - ID:4 *****/
if (var1 != null) 
{
EndTransaction("01_Reward_Details",WLSuccess,false)
}
else
{
EndTransaction("01_Reward_Details",WLError,true,"Failed")
}
// END WLIDE</NodeScript><NodeID Visible="0">4</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">86</StartJSBlockLine><JSBlockLength Visible="0">11</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="285"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">Sleep</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - Sleep - ID:7 *****/

Sleep(500)

 // END WLIDE</NodeScript><NodeID Visible="0">7</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">97</StartJSBlockLine><JSBlockLength Visible="0">6</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="286"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:16 *****/
// These two Rewards have attributes, hence this would follow the below script instead of the default one in else condition.

if ( Reward_Col1.getValue() == "ROM0013139" )
{
//Do nothing
 // END WLIDE</NodeScript><NodeID Visible="0">16</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">103</StartJSBlockLine><JSBlockLength Visible="0">8</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="287"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:19 *****/
}
else 
{
// END WLIDE</NodeScript><NodeID Visible="0">19</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:19 *****/
}

else 
{
// END WLIDE
</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">111</StartJSBlockLine><JSBlockLength Visible="0">6</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="288"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">BeginTransaction::02_2FA_Reward_Redemption_Challange</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - BeginTransaction::02_2FA_Reward_Redemption_Challange - ID:12 *****/
BeginTransaction("02_2FA_Reward_Redemption_Challange")

 // END WLIDE</NodeScript><NodeID Visible="0">12</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">117</StartJSBlockLine><JSBlockLength Visible="0">5</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="289"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:13 *****/
wlGlobals.SSLUseSNI = true;
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.ReportHttpErrors = false  //This will ensure that 403 is not reported as error
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
//wlHttp.Header["Organisation"] = "ANDROIDAPP"
wlTemporary = "&lt;rewardRedemption&gt;\x0A"
wlTemporary+="&lt;requestId&gt;"+reqID+"&lt;/requestId&gt;\x0A"
wlTemporary+="&lt;items&gt;\x0A"
wlTemporary+="&lt;item&gt;\x0A"
wlTemporary+="&lt;redeemableId&gt;"+var1+"&lt;/redeemableId&gt;\x0A"
wlTemporary+="&lt;quantity&gt;1&lt;/quantity&gt;\x0A"
wlTemporary+="&lt;/item&gt;\x0A"
wlTemporary+="&lt;/items&gt;\x0A"
wlTemporary+="&lt;/rewardRedemption&gt;\x0A"
wlHttp.Data["Value"] =wlTemporary
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Post("https://api.t0.nectar.com/collector/reward-redemptions")
//Extracting the transction Id
var2 = extractValue( "&lt;redemptionTransactionId&gt;","&lt;/redemptionTransactionId&gt;", document.wlSource)

 // END WLIDE</NodeScript><NodeID Visible="0">13</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">122</StartJSBlockLine><JSBlockLength Visible="0">25</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="290"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">EndTransaction::02_2FA_Reward_Redemption_Challange</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - EndTransaction::02_2FA_Reward_Redemption_Challange - ID:14 *****/

if (document.wlStatusNumber != 200)
{
EndTransaction("02_2FA_Reward_Redemption_Challange",WLSuccess,false)
}
else
{
EndTransaction("02_2FA_Reward_Redemption_Challange",WLError,true,"Redemption failed")
}
// END WLIDE</NodeScript><NodeID Visible="0">14</NodeID><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">147</StartJSBlockLine><JSBlockLength Visible="0">12</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="291"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">Sleep</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - Sleep - ID:67 *****/

Sleep(5000)

 // END WLIDE</NodeScript><NodeID Visible="0">67</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - Sleep - ID:67 *****/

Sleep(5000)

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">159</StartJSBlockLine><JSBlockLength Visible="0">6</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="292"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:51 *****/
if (document.wlStatusNumber != 201)
{
// END WLIDE</NodeScript><NodeID Visible="0">51</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:51 *****/
if (document.wlStatusNumber != 201)
{
// END WLIDE
</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">165</StartJSBlockLine><JSBlockLength Visible="0">5</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="293"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">BeginTransaction::01_Coll_Reward_Redemptions</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - BeginTransaction::01_Coll_Reward_Redemptions - ID:37 *****/
BeginTransaction("03_Coll_2FA_Reward_Redemptions")

 // END WLIDE</NodeScript><NodeID Visible="0">37</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - BeginTransaction::01_Coll_Reward_Redemptions - ID:37 *****/
BeginTransaction("03_Coll_2FA_Reward_Redemptions")

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">170</StartJSBlockLine><JSBlockLength Visible="0">5</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="294"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:38 *****/
wlGlobals.SSLUseSNI = true;
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.ReportHttpErrors = false  //This will ensure that 403 is not reported as error
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
wlHttp.Header["2fa-code"] = a
wlTemporary = "&lt;rewardRedemption&gt;\x0A"
wlTemporary+="&lt;requestId&gt;"+reqID+"&lt;/requestId&gt;\x0A"
wlTemporary+="&lt;items&gt;\x0A"
wlTemporary+="&lt;item&gt;\x0A"
wlTemporary+="&lt;redeemableId&gt;"+var1+"&lt;/redeemableId&gt;\x0A"
wlTemporary+="&lt;quantity&gt;1&lt;/quantity&gt;\x0A"
wlTemporary+="&lt;/item&gt;\x0A"
wlTemporary+="&lt;/items&gt;\x0A"
wlTemporary+="&lt;/rewardRedemption&gt;\x0A"
wlHttp.Data["Value"] =wlTemporary
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Post("https://api.t0.nectar.com/collector/reward-redemptions")
//Extracting the transction Id
var2 = extractValue( "&lt;redemptionTransactionId&gt;","&lt;/redemptionTransactionId&gt;", document.wlSource)

 // END WLIDE</NodeScript><NodeID Visible="0">38</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:38 *****/
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.ReportHttpErrors = false  //This will ensure that 403 is not reported as error
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
wlHttp.Header["2fa-code"] = a
wlTemporary = "&lt;rewardRedemption&gt;\x0A"
wlTemporary+="&lt;requestId&gt;"+reqID+"&lt;/requestId&gt;\x0A"
wlTemporary+="&lt;items&gt;\x0A"
wlTemporary+="&lt;item&gt;\x0A"
wlTemporary+="&lt;redeemableId&gt;"+var1+"&lt;/redeemableId&gt;\x0A"
wlTemporary+="&lt;quantity&gt;1&lt;/quantity&gt;\x0A"
wlTemporary+="&lt;/item&gt;\x0A"
wlTemporary+="&lt;/items&gt;\x0A"
wlTemporary+="&lt;/rewardRedemption&gt;\x0A"
wlHttp.Data["Value"] =wlTemporary
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Post("https://api.t0.nectar.com/collector/reward-redemptions")
//Extracting the transction Id
var2 = extractValue( "&lt;redemptionTransactionId&gt;","&lt;/redemptionTransactionId&gt;", document.wlSource)

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">175</StartJSBlockLine><JSBlockLength Visible="0">25</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="295"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">EndTransaction::03_Coll_2FA_Reward_Redemptions</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - EndTransaction::03_Coll_2FA_Reward_Redemptions - ID:39 *****/

if (document.wlStatusNumber == 201)
{
EndTransaction("03_Coll_2FA_Reward_Redemptions",WLSuccess,false)
}
else
{
EndTransaction("03_Coll_2FA_Reward_Redemptions",WLError,true,"Redemption failed")
}
}
// END WLIDE</NodeScript><NodeID Visible="0">39</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - EndTransaction::03_Coll_2FA_Reward_Redemptions - ID:39 *****/

if (var2 != null)
{
EndTransaction("03_Coll_2FA_Reward_Redemptions",WLSuccess,false)
}
else
{
EndTransaction("03_Coll_2FA_Reward_Redemptions",WLError,true,"Redemption failed")
}
}
// END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">200</StartJSBlockLine><JSBlockLength Visible="0">13</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="296"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">BeginTransaction::01_Coll_Reward_Reversal</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - BeginTransaction::01_Coll_Reward_Reversal - ID:53 *****/
BeginTransaction("04_Coll_Redemption_Reversal")

 // END WLIDE</NodeScript><NodeID Visible="0">53</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - BeginTransaction::01_Coll_Reward_Reversal - ID:53 *****/
BeginTransaction("04_Coll_Redemption_Reversal")

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">213</StartJSBlockLine><JSBlockLength Visible="0">5</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="297"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:54 *****/
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Data["Value"] =" "
wlHttp.Post("https://api.t0.nectar.com/collector/reward-redemptions/"+var2+"/reversals")
var res = document.wlStatusNumber


 // END WLIDE</NodeScript><NodeID Visible="0">54</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:54 *****/
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Data["Value"] =" "
wlHttp.Post("https://api.t0.nectar.com/collector/reward-redemptions/"+var2+"/reversals")
var res = document.wlStatusNumber


 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">218</StartJSBlockLine><JSBlockLength Visible="0">13</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="298"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">EndTransaction::01_Coll_Reward_Redemptions</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - EndTransaction::01_Coll_Reward_Redemptions - ID:55 *****/
if (res==201) 
{
EndTransaction("04_Coll_Redemption_Reversal",WLSuccess,false)
}
else
{
EndTransaction("04_Coll_Redemption_Reversal",WLError,true,"Redemption failed")
}</NodeScript><NodeID Visible="0">55</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - EndTransaction::01_Coll_Reward_Redemptions - ID:55 *****/
if (res==201) 
{
EndTransaction("04_Coll_Redemption_Reversal",WLSuccess,false)
}
else
{
EndTransaction("04_Coll_Redemption_Reversal",WLError,true,"Redemption failed")
}</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">231</StartJSBlockLine><JSBlockLength Visible="0">10</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="299"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">Sleep</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - Sleep - ID:68 *****/

Sleep(5000)

 // END WLIDE</NodeScript><NodeID Visible="0">68</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - Sleep - ID:68 *****/

Sleep(5000)

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">241</StartJSBlockLine><JSBlockLength Visible="0">6</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="300"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:65 *****/
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~The below script is for Redemption carried out after the 2FA challenge~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// END WLIDE</NodeScript><NodeID Visible="0">65</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:65 *****/
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~The below script is for Redemption carried out after the 2FA challenge~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// END WLIDE
</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">247</StartJSBlockLine><JSBlockLength Visible="0">4</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="301"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:48 *****/
function reqID() {

          var chars = "abcdefghiklmnopqrstuvwxyzaabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz123456789";
          var string_length = 30;
          var RString = '';
          for (var i=0; i&lt;string_length; i++) {

                   var rnum = Math.floor(Math.random() * chars.length);
                   RString += chars.substring(rnum,rnum+1);
          }
          return RString
}
req = reqID()
//InfoMessage(req)
// END WLIDE</NodeScript><NodeID Visible="0">48</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:48 *****/
function randomString(length) {
    return Math.round((Math.pow(36, length + 1) - Math.random() * Math.pow(36, length))).toString(36).slice(1);
}

req = randomString()
InfoMessage(req)
// END WLIDE
</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">251</StartJSBlockLine><JSBlockLength Visible="0">17</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="302"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">BeginTransaction::03_NO_2FA_Reward_Redemption</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - BeginTransaction::03_NO_2FA_Reward_Redemption - ID:43 *****/
BeginTransaction("03_NO_2FA_Reward_Redemption")

 // END WLIDE</NodeScript><NodeID Visible="0">43</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - BeginTransaction::02_2FA_Reward_Redemption_Challange - ID:43 *****/
BeginTransaction("02_2FA_Reward_Redemption_Challange")

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">268</StartJSBlockLine><JSBlockLength Visible="0">5</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="303"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:44 *****/
wlGlobals.SSLUseSNI = true;
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.ReportHttpErrors = false  //This will ensure that 403 is not reported as error
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
wlHttp.ReportHttpErrors = false   // This needs to be REMOVED once the 2FA issue is resolved.
wlTemporary = "&lt;rewardRedemption&gt;\x0A"
wlTemporary+="&lt;requestId&gt;"+req+"&lt;/requestId&gt;\x0A"
wlTemporary+="&lt;items&gt;\x0A"
wlTemporary+="&lt;item&gt;\x0A"
wlTemporary+="&lt;redeemableId&gt;"+var1+"&lt;/redeemableId&gt;\x0A"
wlTemporary+="&lt;quantity&gt;1&lt;/quantity&gt;\x0A"
wlTemporary+="&lt;/item&gt;\x0A"
wlTemporary+="&lt;/items&gt;\x0A"
wlTemporary+="&lt;/rewardRedemption&gt;\x0A"
wlHttp.Data["Value"] =wlTemporary
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Post("https://api.t0.nectar.com/collector/reward-redemptions")

var3 = extractValue( "&lt;redemptionTransactionId&gt;","&lt;/redemptionTransactionId&gt;", document.wlSource)
 // END WLIDE</NodeScript><NodeID Visible="0">44</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:44 *****/
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.ReportHttpErrors = false  //This will ensure that 403 is not reported as error
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
wlHttp.Header["Organisation"] = "NECTMOBILE"
wlTemporary = "&lt;rewardRedemption&gt;\x0A"
wlTemporary+="&lt;requestId&gt;"+reqID+"&lt;/requestId&gt;\x0A"
wlTemporary+="&lt;items&gt;\x0A"
wlTemporary+="&lt;item&gt;\x0A"
wlTemporary+="&lt;redeemableId&gt;"+var1+"&lt;/redeemableId&gt;\x0A"
wlTemporary+="&lt;quantity&gt;1&lt;/quantity&gt;\x0A"
wlTemporary+="&lt;/item&gt;\x0A"
wlTemporary+="&lt;/items&gt;\x0A"
wlTemporary+="&lt;/rewardRedemption&gt;\x0A"
wlHttp.Data["Value"] =wlTemporary
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Post("https://api.t0.nectar.com/collector/reward-redemptions")
//Extracting the transction Id
//var2 = extractValue( "&lt;redemptionTransactionId&gt;","&lt;/redemptionTransactionId&gt;", document.wlSource)

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">273</StartJSBlockLine><JSBlockLength Visible="0">24</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="304"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">EndTransaction::03_NO_2FA_Reward_Redemption</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - EndTransaction::03_NO_2FA_Reward_Redemption - ID:45 *****/

if (document.wlStatusNumber == 201)
{
EndTransaction("03_NO_2FA_Reward_Redemption",WLSuccess,false)
}
else
{
EndTransaction("03_NO_2FA_Reward_Redemption",WLError,true,"Redemption failed")
}
// END WLIDE</NodeScript><NodeID Visible="0">45</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - EndTransaction::02_2FA_Reward_Redemption_Challange - ID:45 *****/

if (document.wlStatusNumber == 200)
{
EndTransaction("02_2FA_Reward_Redemption_Challange",WLSuccess,false)
}
else
{
EndTransaction("02_2FA_Reward_Redemption_Challange",WLError,true,"Redemption failed")
}
// END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">297</StartJSBlockLine><JSBlockLength Visible="0">12</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="305"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:66 *****/
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Reversal for the above redemption  No2FA~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// END WLIDE</NodeScript><NodeID Visible="0">66</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:66 *****/
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Reversal for the above redemption  No2FA~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// END WLIDE
</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">309</StartJSBlockLine><JSBlockLength Visible="0">4</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="306"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">Sleep</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - Sleep - ID:69 *****/

Sleep(2000)

 // END WLIDE</NodeScript><NodeID Visible="0">69</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - Sleep - ID:69 *****/

Sleep(500)

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">313</StartJSBlockLine><JSBlockLength Visible="0">6</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="307"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">BeginTransaction::01_Coll_Reward_Reversal</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - BeginTransaction::01_Coll_Reward_Reversal - ID:56 *****/
BeginTransaction("04_NO2FA_Redemption_Reversal")

 // END WLIDE</NodeScript><NodeID Visible="0">56</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - BeginTransaction::01_Coll_Reward_Reversal - ID:56 *****/
BeginTransaction("04_NO2FA_Redemption_Reversal")

 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">319</StartJSBlockLine><JSBlockLength Visible="0">5</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="308"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">JavaScript</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - JavaScript - ID:57 *****/
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Data["Value"] =" "
wlHttp.Post("https://certapi.t0.nectar.com/collector/reward-redemptions/"+var3+"/reversals")
var res = document.wlStatusNumber


 // END WLIDE</NodeScript><NodeID Visible="0">57</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - JavaScript - ID:57 *****/
wlHttp.SaveSource= true;
wlGlobals.OverrideAuthorizationHeader = true
wlHttp.Header["User-Agent"] =  "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.72 Safari/537.36"
wlHttp.Header["Authorization"] = "Bearer "+Col_CardNo_Col1.getValue()   //26185ff8-179e-4f31-8684-14c724e0aafd"
wlHttp.Data["Type"] ="application/vnd.com.nectar+xml" 
wlHttp.Data["Value"] =" "
wlHttp.Post("https://certapi.t0.nectar.com/collector/reward-redemptions/"+var3+"/reversals")
var res = document.wlStatusNumber


 // END WLIDE</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">324</StartJSBlockLine><JSBlockLength Visible="0">13</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject></JavaScriptObject><JavaScriptObject CallBack="Do_JavaScriptObject" ClonedXML="0" ObjectID="309"><Properties><PropertyPage Name="Attributes"><ItemName ReadOnly="0">EndTransaction::01_Coll_Reward_Redemptions</ItemName><Comments Type="MultiLineString" ReadOnly="0"/></PropertyPage><PropertyPage Name="JavaScript" Visible="0"><NodeScript ReadOnly="0">/***** WLIDE - EndTransaction::01_Coll_Reward_Redemptions - ID:58 *****/
if (res==201) 
{
EndTransaction("04_NO2FA_Redemption_Reversal",WLSuccess,false)
}
else
{
EndTransaction("04_NO2FA_Redemption_Reversal",WLError,true,"Redemption failed")
}}</NodeScript><NodeID Visible="0">58</NodeID><PersistentCorrelation Visible="0">/***** WLIDE - EndTransaction::01_Coll_Reward_Redemptions - ID:58 *****/
if (res==201) 
{
EndTransaction("04_NO2FA_Redemption_Reversal",WLSuccess,false)
}
else
{
EndTransaction("04_NO2FA_Redemption_Reversal",WLError,true,"Redemption failed")
}}</PersistentCorrelation><JSScriptToInitAgenda Visible="0"></JSScriptToInitAgenda><JSScriptToInitClient Visible="0"></JSScriptToInitClient><JSScriptToTerminateAgenda Visible="0"></JSScriptToTerminateAgenda><JSScriptToTerminateClient Visible="0"></JSScriptToTerminateClient></PropertyPage><PropertyPage Name="HTTPHeaders" Visible="0"/><PropertyPage Name="NodeProperties"><BuildingBlockIcon/><StartJSBlockLine Visible="0">337</StartJSBlockLine><JSBlockLength Visible="0">10</JSBlockLength><GetFrames Visible="0"/><IsProtocolRecordedNode Visible="0"/><TestTalkMessageID Visible="0"/><RecordingCallback Visible="0"/><Encoded Visible="0"/><ContentType Visible="0"/></PropertyPage></Properties></JavaScriptObject></Agenda></VisualAgenda><PRODUCT_VERSION><ProjectCreatedProductVersion>WebLOADPro Version 9.0.0.118.00  Supports 128 bit SSL </ProjectCreatedProductVersion><LastProjectSavedProductVersion>WebLOADPro Version 10.1.0.133.00  Supports 128 bit SSL </LastProjectSavedProductVersion></PRODUCT_VERSION><PROJECT_TYPE>Protocol</PROJECT_TYPE><AGENDA_OPTIONS><AgendaName xmlns=" Default Project Options"/><Options><DiagnosticOptions><bSyntaxCheck>0</bSyntaxCheck><bTraceCheck>0</bTraceCheck><bAutomaticStateCheck>0</bAutomaticStateCheck><bSaveCSJSCheck>0</bSaveCSJSCheck><bCSJSDiagnosticMessages>0</bCSJSDiagnosticMessages></DiagnosticOptions><FunctionalTestingOptions><bTransFailed>0</bTransFailed><nFailedTime>20</nFailedTime><nSeverity>2</nSeverity><sTextSearch></sTextSearch><bCheckCRC>0</bCheckCRC><bCheckCompareValues>0</bCheckCompareValues><VarificationData><nCompareTitle>2</nCompareTitle><nFramesNumber>0</nFramesNumber><nTextSearch>0</nTextSearch><nVerifyLink>0</nVerifyLink><nCompareLinks>0</nCompareLinks><nCompareForms>0</nCompareForms><nCompareImages>0</nCompareImages><nCompareTables>0</nCompareTables></VarificationData></FunctionalTestingOptions><SleepTimeControlOptions><nSleepControlType>1</nSleepControlType><nBetween>2</nBetween><nAnd>10</nAnd><nDeviationPersent>10</nDeviationPersent></SleepTimeControlOptions><IE_OPTIONS Option_version="19">
			<IE_DIALOG name="Alert">
				<readonly>yes</readonly>
				<Answer>
					<value>OK</value>
					<default>OK</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="Confirm">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="Prompt">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
				<field type="string" name="Input"></field>
			</IE_DIALOG>
			<IE_DIALOG name="Print">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="Cookie_IE6">
				<Answer>
					<value>Allow</value>
					<value>Block</value>
					<default>Allow</default>
				</Answer>
				<field type="checkbox" name="ApplyToAll">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="Cookie">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
				<field type="checkbox" name="NeverShow">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="FormSubmit">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
				<field type="checkbox" name="NeverShow">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="FormResubmit">
				<Answer>
					<value>Retry</value>
					<value>Cancel</value>
					<default>Retry</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="SwitchNonSecure">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
				<field type="checkbox" name="NeverShow">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="SwitchSecure">
				<Answer>
					<value>OK</value>
					<default>OK</default>
				</Answer>
				<field type="checkbox" name="NeverShow">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="NonSecureOnSecure">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="ClientAuthentication">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
				<field type="string" name="Username"></field>
				<field type="string" name="Password"></field>
				<field type="string" name="Domain"></field>
				<field type="checkbox" name="Save">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="ConnectToMS_WinXP">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
				<field type="string" name="Email"></field>
				<field type="string" name="Password"></field>
				<field type="checkbox" name="AutoSignIn">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="ClientAuthentication_WinXP">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
				<field type="string" name="Username"></field>
				<field type="string" name="Password"></field>
				<field type="checkbox" name="Save">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="ClientCertificate">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
				<field type="string" name="Certificate">
					<default>0</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="HostCertificate">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="FileDownload">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
				<field type="checkbox" name="AlwaysAsk">
					<default>checked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="FileDownload_IE6">
				<Answer>
					<value>Open</value>
					<value>Save</value>
					<value>Cancel</value>
					<default>Save</default>
				</Answer>
				<field type="checkbox" name="AlwaysAsk">
					<default>checked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="FileDownload_IE6_XP">
				<Answer>
					<value>Open</value>
					<value>Save</value>
					<value>Cancel</value>
					<default>Save</default>
				</Answer>
				<field type="checkbox" name="AlwaysAsk">
					<default>checked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="SaveFile">
				<Answer>
					<value>Save</value>
					<value>Cancel</value>
					<default>Save</default>
				</Answer>
				<field type="string" name="FileName"></field>
			</IE_DIALOG>
			<IE_DIALOG name="SaveFileConfirmation">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="ActiveXInstall">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
				<field type="checkbox" name="AlwaysTrust">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="RunActiveX">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="UnsafeActiveX">
				<readonly>yes</readonly>
				<Answer>
					<value>OK</value>
					<default>OK</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="ScriptAccessingActiveX">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="NavigateSubFrames">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="ActiveScripting">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="JavaScripting">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="Redirection">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
				<field type="checkbox" name="NeverShow">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="AutoComplete">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>No</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="RememberPassword">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>No</default>
				</Answer>
				<field type="checkbox" name="DoNotOffer">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="FtpAuthentication">
				<Answer>
					<value>Login</value>
					<value>Cancel</value>
					<default>Login</default>
				</Answer>
				<field type="string" name="Server"></field>
				<field type="string" name="Username"></field>
				<field type="string" name="Password"></field>
				<field type="string" name="Email"></field>
				<field type="checkbox" name="Anonymous">
					<default>unchecked</default>
				</field>
				<field type="checkbox" name="Save">
					<default>unchecked</default>
				</field>
			</IE_DIALOG>
			<IE_DIALOG name="FtpFolderError">
				<readonly>yes</readonly>
				<Answer>
					<value>OK</value>
					<default>OK</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="DocumentModified">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<value>Cancel</value>
					<default>No</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="JavascriptError">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>No</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="WindowClosing">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="SuspiciousActiveX">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="Reboot">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>No</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="YesNoCancel">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<value>Cancel</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="YesNo">
				<Answer>
					<value>Yes</value>
					<value>No</value>
					<default>Yes</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="OkCancel">
				<Answer>
					<value>OK</value>
					<value>Cancel</value>
					<default>OK</default>
				</Answer>
			</IE_DIALOG>
			<IE_DIALOG name="Ok">
				<readonly>yes</readonly>
				<Answer>
					<value>OK</value>
					<default>OK</default>
				</Answer>
			</IE_DIALOG>
		</IE_OPTIONS><PlayBackOptions><nNavigationTimeOut>60</nNavigationTimeOut><nFileDownloadTimeout>0</nFileDownloadTimeout><nStartNavigationTimeOut>3</nStartNavigationTimeOut><bClearCache>0</bClearCache><bClearCookies>0</bClearCookies><nPlaybackMode>1</nPlaybackMode><bUseDOROptimizer>0</bUseDOROptimizer></PlayBackOptions><PassFailDefinition><bCheckErrors>1</bCheckErrors><bCheckSevere>1</bCheckSevere><bCheckWarnings>0</bCheckWarnings><nErrorNum>1</nErrorNum><nRuleCheck>15</nRuleCheck><nWarningNum>15</nWarningNum></PassFailDefinition><ErrorHandling><SubmitButton>1</SubmitButton><NavObject>9</NavObject><Page>4</Page><PageRetryNum>3</PageRetryNum><Object>6</Object></ErrorHandling><EmulationPlaybackOptions><bUseOptimizer>1</bUseOptimizer><bUseHistory>0</bUseHistory><nHistoryLimit>1</nHistoryLimit><bCodeFormatter>0</bCodeFormatter><bCSJSRecovery>1</bCSJSRecovery></EmulationPlaybackOptions><WebServices><sBasicPassword></sBasicPassword><sUserName></sUserName><sProxyHost></sProxyHost><sProxyPassword></sProxyPassword><sProxyUser></sProxyUser><sProxyPort></sProxyPort><nWSClientType>1</nWSClientType></WebServices><BrowserEmulationOptions><bDNSCache>1</bDNSCache><bSSLCache>1</bSSLCache><bKeepAlive>1</bKeepAlive><bRedirectionEnabled>1</bRedirectionEnabled><nRedirectionLimit>10</nRedirectionLimit><strBrowserType>Microsoft Internet Explorer</strBrowserType><strUserAgent>Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)</strUserAgent><strEncodingValue>0</strEncodingValue><bEnforceEncoding>0</bEnforceEncoding></BrowserEmulationOptions><HTTPParametersOptions><bGZipSupport>0</bGZipSupport><bHTTPVersion>1</bHTTPVersion><bMultiIPSupport>0</bMultiIPSupport><bEncodeFormData>1</bEncodeFormData><bAcceptLanguage>0</bAcceptLanguage><strAcceptLanguage></strAcceptLanguage></HTTPParametersOptions><Authentication><sUserName></sUserName><sPassWord></sPassWord><sNTUserName></sNTUserName><sNTUserPassword></sNTUserPassword><sKerberosServer></sKerberosServer><iAuthType>0</iAuthType><sProxyUserName></sProxyUserName><sProxyPassWord></sProxyPassWord><sProxyHost></sProxyHost><sProxyPort></sProxyPort><sSSLClientCertificateFile>C:\Program Files\RadView\WebLOAD\bin\Certificates\server.pem</sSSLClientCertificateFile><sSSLClientCertificatePassword></sSSLClientCertificatePassword></Authentication><BrowserCacheOptions><bFilterApplets>1</bFilterApplets><bFilterImages>1</bFilterImages><bFilterJSFiles>1</bFilterJSFiles><bFilterStyleSheets>1</bFilterStyleSheets><bFilterXMLFiles>1</bFilterXMLFiles><bFilterDynamic>0</bFilterDynamic><nCacheType>3</nCacheType></BrowserCacheOptions><JavaOptions><strSelectedJVM>Default</strSelectedJVM></JavaOptions></Options></AGENDA_OPTIONS><RECORD_OPTIONS><File_Extensions><IgnoredExtensions>|gif|mov|mpg|txt|mpeg|class|cab|jpeg|jpg|css|csx|png|js|jsx|mp3|mp4|</IgnoredExtensions><RecordedExtensions>|asp|htm|html|xml|aspx|jsp|swf|php|cgi|none|</RecordedExtensions><RecordAllExtensions>0</RecordAllExtensions><RecordUnknownExtensions>0</RecordUnknownExtensions></File_Extensions><Security><EncryptProtocolPasswords>1</EncryptProtocolPasswords><EncryptFormPasswords>0</EncryptFormPasswords><PasswordsFormFields>|password|pass|passwd|</PasswordsFormFields></Security><Content_Types><IgnoredTypes>|image/gif|image/jpeg|</IgnoredTypes><RecordedTypes>|text/html|text/plain|text/xml|application/xml|application/json|application/x-amf|application/x-shockwave-flash|</RecordedTypes><RecordAllTypes>0</RecordAllTypes><RecordUnknownTypes>0</RecordUnknownTypes></Content_Types><Post_Data><Data>|text/xml|application/json; charset=utf-8|application/xml; charset=utf-8|application/json-rpc|text/xml; charset=utf-8|</Data><Datafile>|multipart/form-data|</Datafile><RecordUnknownPostTypesAsFiles>1</RecordUnknownPostTypesAsFiles></Post_Data><Proxy_Options><ProxyPort>9885</ProxyPort><SecondaryProxyName></SecondaryProxyName><SecondaryProxyExceptions></SecondaryProxyExceptions><SecondaryProxyPort>1</SecondaryProxyPort><SecondaryProxySslName></SecondaryProxySslName><SecondaryProxySslPort>1</SecondaryProxySslPort><UseSecondaryProxy>0</UseSecondaryProxy><UseSystemProxy>1</UseSystemProxy><SecondaryProxyUserName></SecondaryProxyUserName><SecondaryProxyPassword></SecondaryProxyPassword><AuthUserName></AuthUserName><AuthUserPassword></AuthUserPassword><UseTransparentProxy>0</UseTransparentProxy></Proxy_Options><Proxy_Certificates><ServerCertFileName>C:\Program Files\RadView\WebLOAD\bin\Certificates\server.pem</ServerCertFileName><ServerCertPassword>password</ServerCertPassword><ServerCertTrustFileName>C:\Program Files\RadView\WebLOAD\bin\Certificates\root.pem</ServerCertTrustFileName><ClientCertFileName></ClientCertFileName><ClientCertPassword></ClientCertPassword></Proxy_Certificates><Script_Content><CommentRequestHeaders>0</CommentRequestHeaders><CommentResponseHesders>0</CommentResponseHesders><CommentStatus>0</CommentStatus><DecodeQueryString>1</DecodeQueryString><RecordAuthentication>1</RecordAuthentication><RecordHeaders>0</RecordHeaders><RecordProxy>1</RecordProxy><RecordProxyAuthentication>1</RecordProxyAuthentication><RecordRedirectionPath>0</RecordRedirectionPath><RecordRefererHeader>1</RecordRefererHeader><EncodeBinaryData>0</EncodeBinaryData><RecordViewstateData>1</RecordViewstateData><RecordCustomHeaders>1</RecordCustomHeaders><SaveRedirectionHeaders>0</SaveRedirectionHeaders><SaveClientSideCookies>0</SaveClientSideCookies></Script_Content><Default_Encoding_Type><DefaultEncodingType>0</DefaultEncodingType></Default_Encoding_Type><Default_Browser_Selection><BrowserType>0</BrowserType><ListNetscapeAndMicrosoftBrowserws>|Chrome|Microsoft Internet Explorer|</ListNetscapeAndMicrosoftBrowserws><SelectedBrowser>Chrome</SelectedBrowser><OtherBrowser>c:\program files\google\chrome\application\chrome.exe  --ignore-certificate-errors</OtherBrowser><SetAutoProxyDefs>1</SetAutoProxyDefs><ClearCache>1</ClearCache><ClearCookies>1</ClearCookies><CreateNewBrowser>1</CreateNewBrowser><MobileBrowserType></MobileBrowserType><MobileUserAgent></MobileUserAgent><BrowserWidth>0</BrowserWidth><BrowserHeight>0</BrowserHeight><IsSimulateMobile>0</IsSimulateMobile></Default_Browser_Selection><Correlation_options><AutoCorrelation>3</AutoCorrelation><CorrLogLevel>1</CorrLogLevel><CorrAddComments>1</CorrAddComments><CorrPreserveUser>1</CorrPreserveUser><CorrRulesFilename>C:\Program Files\RadView\WebLOAD\extensions\Correlation\correlationRules.xml</CorrRulesFilename><CorrLogFilename>C:\Documents and Settings\All Users\Application Data\RadView\WebLOAD\Log\correlation.log</CorrLogFilename><ConvertHiddenFields>0</ConvertHiddenFields><CorrFlex>1</CorrFlex><DSIds>0</DSIds></Correlation_options><Correlation_Auto_options><CorrShowForm>2</CorrShowForm><CorrScoreTreshold>1</CorrScoreTreshold><CorrValueLength>0A21C888</CorrValueLength><CorrValueDelimeters>\#/?+;`': "&lt;&gt;()&amp; =	|</CorrValueDelimeters></Correlation_Auto_options><Filter_Url_options><FilteredUrls>|g.msn|http://api.bing.com/qsml.aspx*|http://clients?.google.co.il/*|http://clients?.google.com/*|http://go.microsoft.com/browserconfig.xml|http://ieonline.microsoft.com/s/iess/instrumentation.cer|http://www.google.com/complete/search*|http://www.google.com/tools/toolbar/*|https://clients?.google.co.il/*|https://clients?.google.com/*|https://go.microsoft.com/fwlink/*|https://iecvlist.microsoft.com/IE11/*/iecompatviewlist.xml|https://ieonline.microsoft.com/ieflipahead/ie10/rules.xml*|https://t.urs.microsoft.com/urstelemetry.asmx*|https://translate.googleapis.com/translate_a/l/*|https://www.google.com/searchdomaincheck/*|https://www.gstatic.com/chrome/config/plugins_win.json|pgq.microsoft.com|safebrowsing.clients.google.com|safebrowsing.google.com|safebrowsing-cache.google.com|sqm.microsoft.com|toolbar.google.co.il|toolbar.google.com|toolbar.msn.com|toolbarqueries.google|update.microsoft.com|urs.microsoft.com|us.update.toolbar.com|windowsupdate.microsof.com|www.download.windowsupdate.com|</FilteredUrls><OnlyUrls>|https://www.foryourewards.co.uk|</OnlyUrls></Filter_Url_options></RECORD_OPTIONS><ADDITIONAL_INFORMATION><ProjectComments></ProjectComments><CreatedBy></CreatedBy><Custom1></Custom1><Custom2></Custom2><Custom3></Custom3><Subject></Subject><TestDescription></TestDescription><ResultsDescription></ResultsDescription><VersionBuild></VersionBuild><Title>C:\PerformanceTesting\Projects\STD_TESTSCRIPTS\OpenAPI\OAuth_GReq.wlp</Title></ADDITIONAL_INFORMATION><ORACLE_PROJECT_INCLUDE_PATH></ORACLE_PROJECT_INCLUDE_PATH><BreakPointsMap/></Project>